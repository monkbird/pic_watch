# 照片查看工具

## 功能概览
- 批量/单张查看图片（JPEG/PNG/TIFF/WEBP/HEIF/HEIC 等）
- 读取元数据（EXIF、IPTC、尺寸、文件信息），生成 `metadata.json`
- 分组与筛选：文件夹、时间、年份、备注（按图像描述拆分片段）
- 卡片网格视图：固定3列、响应式卡片宽度、信息显示（格式/尺寸/大小/日期）
- 操作：双击查看大图、复制路径、打开属性/所在文件夹、删除到回收站
- 性能：缩略图缓存（按尺寸桶）、异步生成、虚拟化渲染（仅视口渲染）

## 环境与安装
- Python 3.9+
- 依赖安装：
  - `pip install -r requirements.txt`
  - 可选开发工具：`pip install -r requirements-dev.txt`

## 启动与使用
- 桌面应用：
  - `python app.py gui`
  - 顶部工具栏：选择文件夹、导出分组、日志、搜索/过滤、刷新
- 命令行扫描：
  - `python app.py scan <图片目录> --output <输出路径>`

## 视图与分组
- 左侧分组面板：文件夹/时间/年份/备注（数量列居中、7:3 列宽）
- 右侧卡片网格：固定每行3张，卡片随窗口宽度伸缩；分组/筛选后滚动条重置到顶部
- 状态栏：显示“已选 X / 总计 Y”；复制/删除后反馈结果

## 快捷键与右键菜单
- 双击：打开大图查看器
- Ctrl+C：复制已选图片路径（含文件 URL）
- Delete：删除已选到回收站（带确认）
- 右键菜单：
  - 单选：打开大图/查看属性/打开所在文件夹/复制选中/删除选中
  - 多选：复制选中/删除选中

## 格式支持与元数据
- 图片：`JPEG/PNG/TIFF/WEBP/HEIF/HEIC`（HEIF 需 `pillow-heif`）
- EXIF：`DateTimeOriginal/DateTime/XP*` 等，带编码识别与重解码
- IPTC：Caption/ObjectName/Keywords 等
- TIFF：页数与标签（tifffile）

## 性能说明
- 缩略图写入采用原子替换（先写临时文件再替换）防止读未完成文件
- 缩略图尺寸桶与 `LANCZOS` 采样，提升清晰度并减少重复生成
- 只渲染视口可见卡片，滚动/窗口变化防抖（150ms）

## 已知问题与建议
- 超大目录下可适度降低并发（默认3），或增加缓存清理
- HEIF 支持取决于系统库与 `pillow-heif` 版本

## 目录结构
- `app.py`：入口（CLI 与 GUI）
- `ui/`：界面（分组、网格、卡片、预览、属性等）
- `services/`：扫描与元数据、分组逻辑
- `utils/`：缩略图缓存与后台队列、系统属性/删除、日志

## 许可证
- 默认未设置许可证；如需开源请在仓库中添加 LICENSE 文件。
